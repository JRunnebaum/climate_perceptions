---
title: "Wellbeing"
author: "Laura"
date: "12/14/2020"
output: word_document
---


```{r setup, echo = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message = FALSE, error=FALSE)
```

```{r, packages}
library(tidyverse)
library(lubridate)
library(knitr)
library(grDevices)
library(extrafont)
library(ggrepel)
library(ggthemes)
library(gridExtra)
library(likert)
# windowsFonts(Times=windowsFont("Calibri"))
theme_sleek <- function(base_size = 12, base_family = "Calibri") {
  half_line <- base_size/2
  theme_light(base_size = 12, base_family = "Calibri") +
    theme(
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(),
      axis.ticks.length = unit(half_line / 2.2, "pt"),
      strip.background = element_rect(fill = NA, colour = NA),
      strip.text.x = element_text(colour = "black"),
      strip.text.y = element_text(colour = "black"),
      # axis.text = element_text(colour = "grey30"),
      #axis.title = element_text(colour = "grey30"),
      #legend.title = element_text(colour = "grey30"),#, size = rel(0.9)
      legend.title = element_blank(),
      panel.border = element_rect(fill = NA),#, colour = "grey70", size = 1),
      legend.key.size = unit(0.9, "lines"),
      #legend.text = element_text(size = rel(0.7)),#, colour = "grey30"),
      legend.key = element_rect(colour = NA, fill = NA),
      legend.background = element_rect(colour = NA, fill = NA)#,
      #plot.title = element_text(colour = "grey30"),#, size = rel(1),
      #plot.subtitle = element_text(colour = "grey30")#, size = rel(.85),
     
      
    )
}
theme_set(theme_sleek())
options(scipen = 999) #turns off scientific notation
# Depends on dplyr
tickr <- function(
  data, # dataframe
  var, # column of interest
  to # break point definition 
){
  
  VAR <- enquo(var) # makes VAR a dynamic variable
  
  data %>% 
    distinct(!!VAR) %>%
    ungroup(!!VAR) %>% 
    mutate(labels = ifelse(!!VAR %in% seq(to * round(min(!!VAR) / to), max(!!VAR), to),
                           !!VAR, "")) %>%
    select(breaks = UQ(VAR), labels)
}
```

```{r load data}
responses <- read.csv("../data/PNW_decoded_responses_wstate14.Dec.2020.csv")
```
##wellbeing indicators
##Below is a list of issues that may affect fishing success, your wellbeing, or the wellbeing of your community. For the following questions, please indicate your level of concern. Theme indicated in each section

```{r question 32}
#issues in the marine environement
responses$warming_concern = factor(responses$warming_concern, levels = c("very", "somewhat", "none"))
responses$oa_concern = factor(responses$oa_concern, levels = c("very", "somewhat", "none"))
responses$storm_concern = factor(responses$storm_concern, levels = c("very", "somewhat", "none"))
responses$sea_level_concern = factor(responses$sea_level_concern, levels = c("very", "somewhat", "none"))
responses$weather_concern = factor(responses$weather_concern, levels = c("very", "somewhat", "none"))
responses$h20_quality_concern = factor(responses$h20_quality_concern, levels = c("very", "somewhat", "none"))
responses$algal_concern = factor(responses$algal_concern, levels = c("very", "somewhat", "none"))
responses$habitat_concern = factor(responses$habitat_concern, levels = c("very", "somewhat", "none"))
         
warming <- ggplot(data = responses, aes(x=warming_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
  ylim(0, 90)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+ 
  ggtitle("ocean warming")

oa <- ggplot(data = responses, aes(x=oa_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 90)+
  theme(axis.title.x = element_blank(),axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("OA")

storm <- ggplot(data = responses, aes(x=storm_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 90)+ 
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("storms")

slr <- ggplot(data = responses, aes(x=sea_level_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 90)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("sea level rise")

weather <- ggplot(data = responses, aes(x=weather_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 90)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Changing weather patterns")

h20quality <- ggplot(data = responses, aes(x=h20_quality_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 90)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("water quality")

habs <- ggplot(data = responses, aes(x=algal_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 90)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("HABs")

habitat <- ggplot(data = responses, aes(x=habitat_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 90)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("habitat loss")

environment_concerns_plot<-grid.arrange(warming, oa, storm, slr, weather, h20quality, habs, habitat, nrow = 2, top = "Level of concern for issues in the marine environment", bottom = "concern level", left = "count")

ggsave(plot = environment_concerns_plot, file = paste0("../figures/wellbeing/environment_concerns.png"))
```

##issues that may affect fishing
```{r question 33}
#q33
responses$pop_size_concern = factor(responses$pop_size_concern, levels = c("very", "somewhat", "none"))
responses$bycatch_concern = factor(responses$bycatch_concern, levels = c("very", "somewhat", "none"))
responses$value_concern = factor(responses$value_concern, levels = c("very", "somewhat", "none"))
responses$costs_concern = factor(responses$costs_concern, levels = c("very", "somewhat", "none"))
responses$sa_concern = factor(responses$sa_concern, levels = c("very", "somewhat", "none"))
responses$distance_concern = factor(responses$distance_concern, levels = c("very", "somewhat", "none"))
responses$reg_concern = factor(responses$reg_concern, levels = c("very", "somewhat", "none"))
responses$quota_concern = factor(responses$quota_concern, levels = c("very", "somewhat", "none"))
         
pop_size <- ggplot(data = responses, aes(x=pop_size_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
  ylim(0, 120)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+ 
  ggtitle("Fish populations")

bycatch <- ggplot(data = responses, aes(x=bycatch_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 120)+
  theme(axis.title.x = element_blank(),axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Bycatch")

value <- ggplot(data = responses, aes(x=value_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 120)+ 
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Landed value")

costs <- ggplot(data = responses, aes(x=costs_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 120)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Operational costs")

stockass <- ggplot(data = responses, aes(x=sa_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 120)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Stock assessment")

distance <- ggplot(data = responses, aes(x=distance_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 120)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Travel time")

regs <- ggplot(data = responses, aes(x=reg_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 120)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Regulations")

quota <- ggplot(data = responses, aes(x=quota_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 120)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Quota")

fishing_concerns_plot<-grid.arrange(pop_size, bycatch, value, costs, stockass, distance, regs, quota, nrow = 2, top = "Level of concern for issues related to fishing", bottom = "concern level", left = "count")

ggsave(plot = environment_concerns_plot, file = paste0("../figures/wellbeing/fishing_concerns.png"))
```

##labor force and health
```{r questions 35 and 36}
#q35 and q36

responses$graying_fleet_concern = factor(responses$graying_fleet_concern, levels = c("very", "somewhat", "none"))
responses$fish_comm_concern = factor(responses$fish_comm_concern, levels = c("very", "somewhat", "none"))
responses$resid_concern = factor(responses$resid_concern, levels = c("very", "somewhat", "none"))
responses$infrastructure_concern = factor(responses$infrastructure_concern, levels = c("very", "somewhat", "none"))
responses$phsy_health_concern = factor(responses$phsy_health_concern, levels = c("very", "somewhat", "none"))
responses$mental_health_quality_concern = factor(responses$mental_health_concern, levels = c("very", "somewhat", "none"))
responses$safe_at_sea_concern = factor(responses$safe_at_sea_concern, levels = c("very", "somewhat", "none"))
responses$family_concern = factor(responses$family_concern, levels = c("very", "somewhat", "none"))
         
graying_fleet <- ggplot(data = responses, aes(x=graying_fleet_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
  ylim(0, 90)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+ 
  ggtitle("Graying of the fleet")

fish_comm <- ggplot(data = responses, aes(x=fish_comm_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 90)+
  theme(axis.title.x = element_blank(),axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Fishing community cohesion")

resid_comm <- ggplot(data = responses, aes(x=resid_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 90)+ 
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Residential community cohesion")

infrastructure <- ggplot(data = responses, aes(x=infrastructure_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 90)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Coastal and port infrastructure")

phsy_health <- ggplot(data = responses, aes(x=phsy_health_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 90)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Physical health")

mental_health <- ggplot(data = responses, aes(x=mental_health_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 110)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Mental health")

sas <- ggplot(data = responses, aes(x=safe_at_sea_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 90)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Safety at sea")

family_rel <- ggplot(data = responses, aes(x=family_concern))+
  geom_bar(stat = "count", fill = c("light blue", "navy blue", "purple"))+
   ylim(0, 90)+
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 45))+
  ggtitle("Family relationships")

environment_concerns_plot<-grid.arrange(graying_fleet, fish_comm, resid_comm, infrastructure, phsy_health, mental_health, sas, family_rel, nrow = 2, top = "Level of concern for labor, health, and relationships", bottom = "concern level", left = "count")

ggsave(plot = environment_concerns_plot, file = paste0("../figures/wellbeing/community_concerns.png"))
```

##likert questions about climate and future of fishing
```{r question 37}
#q36 plotting using likert package

q36<-responses %>%
  select(believe, harm_me, harm_future, leave_fishing, new_fishery, no_point, no_fish)

#add statements as column headers
q36_statements<-c(
  "I believe climate change is occurring",
  "Climate change will harm me personally",
  "Climate change will harm future generations",
  "If I had a choice I would leave fishing",
  "It is a big risk to move into a new fishery",
  "There is no point in preparing for climate change since we don't know exactly what is going to happen",
  "There will not be enough fish to continue to operate in my main fishery in 20 years")
colnames(q36)<-q36_statements

#setting the levels
#levels need to be set since each possible answer does not appear in each column
mylevels <- c('strongly_disagree', 'somewhat_disagree', 'neutral', 'somewhat_agree', 'strongly_agree')
for(i in seq_along(q36)) {
  q36[,i] <- factor(q36[,i], levels=mylevels)
}

future_thoughts<-likert(q36)
summary(future_thoughts)
climate_perspectives<-plot(future_thoughts)

climate_perspectives

ggsave(plot = climate_perspectives, file = paste0("../figures/wellbeing/climate_perspectives.png"))

```

##likert questions about conflict
```{r question 38}
#q38 plotting using likert package

q38<-responses %>%
  select(recreational, other_fishery, internal, aquaculture, hatcheries, tourism, development, spatial)

#add statements as column headers
q38_statements<-c(
  "Recreational fisheries",
  "Other commerical fisheries",
  "There is internal conflict within my own commercial fishery",
  "Aquaculture",
  "Hatcheries",
  "Tourism",
  "Coastal development",
  "Competing ocean uses or offshore energy development")
colnames(q38)<-q38_statements

#setting the levels
#levels need to be set since each possible answer does not appear in each column
mylevels <- c('strongly_disagree', 'somewhat_disagree', 'neutral', 'somewhat_agree', 'strongly_agree')
for(i in seq_along(q38)) {
  q38[,i] <- factor(q38[,i], levels=mylevels)
}

conflict<-likert(q38)
summary(conflict)
conflict_title<-"My fishing is negatively affected by:"
conflict_plot<-plot(conflict, 
              colors=c('orange','darkorange', "gray", 'darkblue','blue')) +       ggtitle(conflict_title)

ggsave(plot = conflict_plot, file = paste0("../figures/wellbeing/conflict_plot.png"))

```
##likert questions about health and wellbeing
```{r question 39}
#q39 plotting using likert package

q39<-responses %>%
  select(fish_neg_wellbeing, fish_neg_health, fish_neg_mental, fish_increase_stress, env_neg_welbeing, env_neg_health, env_neg_mental, env_increase_stress, env_neg_safety)

#add statements as column headers
q39_statements<-c(
  "Changes in fisheries have negatively impacted my overall wellbeing",
  "Changes in fisheries have negatively impacted my physical health",
  "Changes in fisheries have negatively impacted my mental health",
  "Changes in fisheries have raised my stress levels",
  "Changes in the environment have negatively impacted my overall wellbeing",
  "Changes in the environment have negatively impacted my physical health",
  "Changes in the environment have negatively impacted my mental health",
  "Changes in the environment have raised my stress levels",
  "Changes in the environment have negatively affected my safety while fishing")
colnames(q39)<-q39_statements

#setting the levels
#levels need to be set since each possible answer does not appear in each column
mylevels <- c('strongly_disagree', 'somewhat_disagree', 'neutral', 'somewhat_agree', 'strongly_agree', "I have not observed any changes")
for(i in seq_along(q39)) {
  q39[,i] <- factor(q39[,i], levels=mylevels)
}

health_wellbeing<-likert(q39)
health_wellbeing_title<-"Level of agreement with the following statements:"
health_wellbeing_plot<-plot(health_wellbeing, 
              colors=c('orange','darkorange', "gray", 'darkblue','blue',       "yellow")) +       
  ggtitle(health_wellbeing_title)

health_wellbeing_plot

ggsave(plot = health_wellbeing_plot, file = paste0("../figures/wellbeing/health_wellbeing_plot.png"))
```
