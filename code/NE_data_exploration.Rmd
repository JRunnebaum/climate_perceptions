---
title: "data exploration"
author: "Jocelyn Runnebaum"
date: '`r format(Sys.Date(), "%B %d, %Y")`'
output: 
   word_document:
    reference_docx: word-styles-reference.docx

---

```{r setup, echo = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message = FALSE, error=FALSE)
```

```{r, packages}
library(tidyverse)
library(lubridate)
library(knitr)
library(grDevices)
library(extrafont)
library(ggrepel)
library(ggthemes)
library(PNWColors)
library(ggplot2)
library(gridExtra)
# windowsFonts(Times=windowsFont("Calibri"))
theme_sleek <- function(base_size = 20, base_family = "Calibri") {
  half_line <- base_size/2
  theme_light(base_size = 20, base_family = "Calibri") +
    theme(
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(),
      axis.ticks.length = unit(half_line / 2.2, "pt"),
      strip.background = element_rect(fill = NA, colour = NA),
      strip.text.x = element_text(colour = "black"),
      strip.text.y = element_text(colour = "black"),
      # axis.text = element_text(colour = "grey30"),
      #axis.title = element_text(colour = "grey30"),
      #legend.title = element_text(colour = "grey30"),#, size = rel(0.9)
      legend.title = element_blank(),
      panel.border = element_rect(fill = NA),#, colour = "grey70", size = 1),
      legend.key.size = unit(0.9, "lines"),
      #legend.text = element_text(size = rel(0.7)),#, colour = "grey30"),
      legend.key = element_rect(colour = NA, fill = NA),
      legend.background = element_rect(colour = NA, fill = NA)#,
      #plot.title = element_text(colour = "grey30"),#, size = rel(1),
      #plot.subtitle = element_text(colour = "grey30")#, size = rel(.85),
     
      
    )
}
theme_set(theme_sleek())
options(scipen = 999) #turns off scientific notation
# Depends on dplyr
tickr <- function(
  data, # dataframe
  var, # column of interest
  to # break point definition 
){
  
  VAR <- enquo(var) # makes VAR a dynamic variable
  
  data %>% 
    distinct(!!VAR) %>%
    ungroup(!!VAR) %>% 
    mutate(labels = ifelse(!!VAR %in% seq(to * round(min(!!VAR) / to), max(!!VAR), to),
                           !!VAR, "")) %>%
    select(breaks = UQ(VAR), labels)
}
```

#color palettes by how many categories there are
```{r}
pal3 <- pnw_palette("Bay", 3, type = "discrete")
pal4 <- pnw_palette("Bay", 4, type = "discrete") #this was pal
pal5 <- pnw_palette("Bay", 5, type = "discrete")
pal6 <- pnw_palette("Bay", 6, type = "continuous")
pal7 <- pnw_palette("Bay", 7, type = "continuous")
```

```{r load data}
responses <- read.csv("../data/decoded_responses_10.Jun.2021.csv") #responses from 10June2021 have been cleaned for port, other fisheries, other fishing regions, and other gear types

responses <- responses %>% 
  mutate(yrs_fishing = case_when(yrs_fishing == "0-5" ~ "0-5",
                                 yrs_fishing == "15-May" ~ "5-15",
                                 yrs_fishing == "15-25" ~ "15-25",
                                 yrs_fishing == "25+" ~ "25+"))
```
# add leading zeros back to zip codes in responses dataframe (they drop off when saving from data cleaning)
#have to add the leading zero back every time
```{r}
for(i in 1:length(responses$home_zip)){
  if(as.numeric(responses$home_zip[i]) < 10000){
    responses$home_zip[i] <- paste0("0", responses$home_zip[i])
  }
}

for(i in 1:length(responses$port_zip)){
  if(as.numeric(responses$port_zip[i]) < 10000){
    responses$port_zip[i] <- paste0("0", responses$port_zip[i])
  }
}
```


#I ADDED ZIPCODES TO DATA CLEANING TO REMOVE IT FROM DATA EXPLORATION - 
```{r zipcode data}
#download zipcode data to match states to responses data by zip code (could add county or other identifying information from these data)

ZipCodeSourceFile = "http://download.geonames.org/export/zip/US.zip"
temp <- tempfile()
download.file(ZipCodeSourceFile , temp)
ZipCodes <- read.table(unz(temp, "US.txt"), sep="\t")
unlink(temp)
names(ZipCodes) = c("CountryCode", "home_zip", "PlaceName",
                    "state", "state_code", "County", "AdminCode2",
                    "AdminName3", "AdminCode3", "latitude", "longitude", "accuracy")

#already have home state as state and state code
# zips<- ZipCodes %>%
  # select(home_zip, state, state_code) %>%
  # mutate(home_zip = as.character(home_zip))
#

portzips<-ZipCodes %>%
  select(home_zip, state, state_code) %>%
  mutate(home_zip = as.integer(home_zip))
#
names(portzips) = c("port_zip", "port_state", "port_state_code")
#
# add leading zero back
for(i in 1:length(portzips$port_zip)){
  if(as.numeric(portzips$port_zip[i]) < 10000){
    portzips$port_zip[i] <- paste0("0", portzips$port_zip[i])
  }
}
```

#Add missing state information
```{r add state data to responses}
#already have home state (state) and home state code (state code)
# responses <- responses %>% 
#   left_join(zips) %>% 
#    droplevels() 
# 
responses <- responses %>%
  left_join(portzips)

#for some reason rows 57, 67, 330, 370 have unidentifiable zipcodes

#57 = MA

responses[57, 294] = "Massachusetts"
responses[57, 295] = "MA"

#67 = RI
responses[67, 294] = "Rhode Island"
responses[67, 295] = "RI"

#330 = MA
responses[330, 294] = "Massachusetts"
responses[330, 295] = "MA"

#370 = ME
responses[370, 294] = "Maine"
responses[370, 295] = "ME"

```
##This section produces basic summaries of the survey responses including demographics and numbers of responses.
#saves plots to a folder in figures called resp_sum (responses summary)

#Responses by Home State
#update by survey region
```{r responses by Home State}
#As of 7.27.2020 we only have one response from New Jersey, should we not report data at a level that doesn't have at least 3 observations for the potential of someone accidentally being identified?

responses$state <- factor(responses$state, levels = c("New Jersey","New York", "Connecticut", "Rhode Island", "Massachusetts", "New Hampshire", "Maine"))

responses$state_code <- factor(responses$state_code, levels = c("NJ","NY", "CT", "RI", "MA", "NH", "ME"))

responses_by_state_plot <- ggplot(data = responses, aes(x=state_code))+
  geom_bar(stat = "count")+
  xlab("State\n")+
  ggtitle("Respondents by State") 

ggsave(plot = responses_by_state_plot, file = paste0("../figures/resp_sum/response_by_state.png"))

#percentage of responses instead of count
responses_by_state_plot <- ggplot(data = responses, aes(x=state_code))+
  geom_bar(aes(y = (..count..)/sum(..count..))) + #, fill = "#749dae"
  scale_y_continuous(labels=scales::percent) +
  xlab("State\n")+ ylab("Percent\n") +
  ggtitle("Respondents by State") 
ggsave(plot = responses_by_state_plot, file = paste0("../figures/resp_sum/percent_response_by_state.png"))

state <- responses %>% 
  select(state) %>% 
  gather(state) %>% 
  group_by(state) %>% 
  count(state)  %>% 
  mutate(survey = 418) %>% 
  mutate(prop = n/survey*100)
state


```



#basic info summary
#update by region region fished from the survey
```{r responses for q 3 - 10}
#q3 regions where people fish
#put in correct regions

regions <-  responses %>%
  select(inshore_gom, offshore_gom, gb, sne, lis, mid, other_region) %>%  #other_region is also an option
  gather(region, response) %>% 
  group_by(region)

regions$region <- factor(regions$region, levels = c("inshore_gom", "offshore_gom", "gb", "sne", "lis", "mid", "other_region"))

region_plot <- ggplot()+
  geom_col(data = regions, aes(x=region, y = response), fill = "#749dae")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 16))+
  xlab("Region\n")+
  ylab("Count\n")+
  ggtitle("Regions Fished\n")

ggsave(plot = region_plot, file = paste0("../figures/resp_sum/regions_fished.png"))
 
 #q3 regions where people fish as a percentage
#put in correct regions
regions <-  responses %>%
  select(inshore_gom, offshore_gom, gb, sne, lis, mid, other_region) %>%  
  gather(region, use) %>% 
  group_by(region) %>% 
  summarise_all(funs(sum))  %>% 
  mutate(survey = 418) %>% 
  mutate(prop = use/survey)

 
regions$region <- factor(regions$region, levels = c("inshore_gom", "offshore_gom", "gb", "sne", "lis", "mid","other_region"))

region_plot <- ggplot()+
  geom_col(data = regions, aes(x=region, y = prop), fill = "black")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 16))+
  xlab("Region\n")+
  ylab("Proportion\n")+
  ggtitle("Regions Fished\n")+
  scale_y_continuous(labels=scales::percent) 

ggsave(plot = region_plot, file = paste0("../figures/resp_sum/proportion_region_fished.png"))
```

#q4 is an open ended question asking where is your homeport

#q5 how long have you been fishing
```{r}
responses <- responses %>% 
  mutate(yrs_fishing = case_when(yrs_fishing == "0-5" ~ "0-5",
                                 yrs_fishing == "15-May" ~ "5-15",
                                 yrs_fishing == "15-25" ~ "15-25",
                                 yrs_fishing == "25+" ~ "25+"))

responses$yrs_fishing<-factor(responses$yrs_fishing, levels = c("0-5", "5-15", "15-25","25+"))

yrsfishing_plot <- ggplot(data = responses, aes (x=yrs_fishing))+
  geom_bar(fill = pal4, position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 16))+ ylab("Number of Respondents\n")+
  xlab("Category\n")+
  ggtitle("How long have you been fishing") 
ggsave(plot = yrsfishing_plot, file = paste0("../figures/resp_sum/yrsfishing.png"))

#percentage of responses instead of count
yrs_fishing_pct <- ggplot(data = responses, aes(x=yrs_fishing))+
  geom_bar(aes(y = (..count..)/sum(..count..)), fill = "black")+
  scale_y_continuous(labels=scales::percent) +
  xlab("yrs fishing\n")+ ylab("percent") +
  ggtitle("Years Fishing") 

ggsave(plot = yrs_fishing_pct, file = paste0("../figures/resp_sum/yrsfishing_pct.png"))

years_fishing <- responses %>% 
  select(yrs_fishing) %>% 
  gather(yrs_fishing) %>% 
  group_by(yrs_fishing) %>% 
  count(yrs_fishing)  %>% 
  mutate(survey = 418) %>% 
  mutate(prop = n/survey*100)
years_fishing

```

#q6 is an open ended question asking where you live

#q7 how long have you lived in your current community
```{r}
responses <- responses %>% 
  mutate(yrs_residence = case_when(yrs_residence == "0-5" ~ "0-5",
                                 yrs_residence == "1-5" ~ "5-15",
                                 yrs_residence == "15-25" ~ "15-25",
                                 yrs_residence == "25+" ~ "25+"))

responses$yrs_residence<-factor(responses$yrs_residence, levels = c("0-5", "5-15", "15-25","25+"))

yrsresidence_plot <- ggplot(data = responses, aes (x=yrs_residence))+
  geom_bar(fill = pal4, position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 16))+ ylab("Number of Respondents\n")+
  xlab("Category\n")+
  ggtitle("Years Living in Community") 
ggsave(plot = yrsresidence_plot, file = paste0("../figures/resp_sum/yrsresidence.png"))

#percentage of responses instead of count
yrs_res_pct <- ggplot(data = responses, aes(x=yrs_residence))+
  geom_bar(aes(y = (..count..)/sum(..count..)), fill = pal4)+
  scale_y_continuous(labels=scales::percent) +
  xlab("yrs residence\n")+ ylab("percent") +
  ggtitle("Years Living in Community") 

ggsave(plot = yrs_res_pct, file = paste0("../figures/resp_sum/yrsres_pct.png"))

years_residence <- responses %>% 
  select(yrs_residence) %>% 
  gather(yrs_residence) %>% 
  group_by(yrs_residence) %>% 
  count(yrs_residence)  %>% 
  mutate(survey = 418) %>% 
  mutate(prop = n/survey*100)
years_residence

```

#q8 what is your role in the fishing industry
```{r}
job <-  responses %>%
  select(captain, vessel_owner, crew, other_role) %>%  
  gather(role, response) %>% 
  group_by(role)
job$role <- factor(job$role, levels = c("captain", "vessel_owner", "crew", "other_role"))
job_plot <- ggplot()+
  geom_col(data = job, aes(x=role, y = response), fill = "#749dae")+
  xlab("Role\n")+
  ylab("Count\n")+
  ggtitle("Industry role\n")

ggsave(plot = job_plot, file = paste0("../figures/resp_sum/industry_role.png"))
```

#q9 how many crew do you employ
```{r}
responses$crew_num<-factor(responses$crew_num, levels = c("0", "1-3", "4-7", "7-11","11+"))

crewemployed_plot <- ggplot(data = responses, aes (x=crew_num))+
  geom_bar(fill = "navy", position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 16))+ ylab("Number of Respondents\n")+
  xlab("Category\n")+
  ggtitle("How many crew do you employ") 
ggsave(plot = crewemployed_plot, file = paste0("../figures/resp_sum/crew_employed.png"))

#percentage of responses instead of count
crew_employed_pct <- ggplot(data = responses, aes(x=crew_num))+
  geom_bar(aes(y = (..count..)/sum(..count..)), fill = "black")+
  scale_y_continuous(labels=scales::percent) +
  xlab("Number of Crew\n")+ ylab("Percent") +
  ggtitle("Number of Crew Employed") 

ggsave(plot = crew_employed_pct, file = paste0("../figures/resp_sum/crew_employed_pct.png"))

```

#q10 what length vessel do you work on or operate
```{r}

#may need to be modified by region
responses$vessel <- factor(responses$vessel, levels = c("U25", "26-35", "36-45", "46-55", "56-65", "66+"))

vessel_plot <- ggplot(data = responses, aes(x=vessel))+
  geom_bar(stat = "count")+
  xlab("vessel\n")+
  ggtitle("Respondents by Vessel length") 

ggsave(plot = vessel_plot, file = paste0("../figures/resp_sum/responses_vessel.png"))

#percentage instead of count
vessel_pct <- ggplot(data = responses, aes(x=vessel))+
  geom_bar(aes(y = (..count..)/sum(..count..)), fill = "black")+
  scale_y_continuous(labels=scales::percent) +
  xlab("vessel length\n")+ ylab("percent") +
  ggtitle("What length vessel do you work on") 

ggsave(plot = vessel_pct, file = paste0("../figures/resp_sum/vessel_pct.png"))
```

#q11 what gear types do you use
```{r}

#needs to be updated by region:NE longline, midwater trawl, bottom trawl, traps, purse seine, gillnets, rod and reel, other
gears <-  responses %>%
  select(longline, midwater_trwl, bottom_trwl, trap, purse_seine, gillnet, rod_reel, other_gear) %>%  
  gather(gt, use) %>% 
  group_by(gt) %>% 
  summarise_all(funs(sum))  %>% 
  mutate(survey = 418) %>% 
  mutate(prop = use/survey)
 

gears$gt <- factor(gears$gt, levels = c("longline", "midwater_trwl", "bottom_trwl", "trap", "purse_seine", "gillnet", "rod_reel", "other_gear"))

gear_plot <- ggplot()+
  geom_col(data = gears, aes(x=gt, y = prop), fill = "black")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 16))+
  xlab("Gear\n")+
  ylab("Proportion\n")+
  ggtitle("Gear Types\n")+
  scale_y_continuous(labels=scales::percent) 

ggsave(plot = gear_plot, file = paste0("../figures/resp_sum/proportion_gear_type.png"))
```


##q8 and 11 are in long format
##this adds a column at the end of the sheet with the responses so summarize can be used to see differences between the groups

#q8 industry role
#can add in details from open ended responses about other jobs if desired
# I have not updated this section yet as of 6.10.21. Would be good to look at the responses provided for other, think they might include aquaculture activities
```{r}

responses$industry_role = rep(NA, length =  nrow(responses))
for(i in 1: nrow(responses)) {
  inrole = ""
  if(responses$captain[i] == 1) {
    inrole = paste(inrole, "captain", sep = "") 
  }
  if(responses$vessel_owner[i] == 1) {
    if(inrole == "") { # have to do extra to not put a , at the beginning
      # if this is the first fishery 
      inrole = paste(inrole, "vessel owner", sep = "")
    } else {
      inrole = paste(inrole, "vessel owner", sep = ", ")
    }
  }
  if(responses$crew[i] == 1) {
    if(inrole == "") {
      inrole = paste(inrole, "crew", sep = "")
    } else {
      inrole = paste(inrole, "crew", sep = ", ")
    }
  }
  if(responses$other_role[i] == 1) {
    if(inrole == "") { 
    inrole = paste(inrole, "other", sep = "")
    #just use "other" for fewer categories
    }else {
      inrole = paste(inrole, "other", sep = ", ")
    }
  }
  responses$industry_role[i] = inrole
}
#add if details wanted about other role  
#if(responses$other_role[i] == 1) {
    #if(inrole == "") { 
    #inrole = paste(inrole, responses$other_role_descrip[i], sep = "")
    #paste in what the person put for "other"
    #}else {
      #inrole = paste(inrole, responses$other_role_descrip[i], sep = ", ")
    #}
  #}
  #responses$industry_role[i] = inrole
#}
```

#q11 gear types
#can add in details from open ended responses about other gear types if desired
# I have not updated this section yet as of 6.10.21. Would be good to look at the responses provided for other, think they might include claming and aquaculture gear
```{r}


responses$gear_type = rep(NA, length =  nrow(responses))
for(i in 1: nrow(responses)) {
  gtype = ""
  if(responses$longline[i] == 1) {
    gtype = paste(gtype, "longline", sep = "") 
  }
  if(responses$midwater_trwl[i] == 1) {
    if(gtype == "") {  
      gtype = paste(gtype, "midwater trawl", sep = "")
    } else {
      gtype = paste(gtype, "midwater trawl", sep = ", ")
    }
  }
  if(responses$bottom_trwl[i] == 1) {
    if(gtype == "") {  
      gtype = paste(gtype, "bottom trawl", sep = "")
    } else {
      gtype = paste(gtype, "bottom trawl", sep = ", ")
    }
  }
  if(responses$trap[i] == 1) {
    if(gtype == "") {  
      gtype = paste(gtype, "trap", sep = "")
    } else {
      gtype = paste(gtype, "trap", sep = ", ")
    }
  }
  if(responses$purse_seine[i] == 1) {
    if(gtype == "") {  
      gtype = paste(gtype, "purse seine", sep = "")
    } else {
      gtype = paste(gtype, "purse seine", sep = ", ")
    }
  }
  if(responses$gillnet[i] == 1) {
    if(gtype == "") {  
      gtype = paste(gtype, "gillnet", sep = "")
    } else {
      gtype = paste(gtype, "gillnet", sep = ", ")
    }
  }
  if(responses$rod_reel[i] == 1) {
    if(gtype == "") {  
      gtype = paste(gtype, "rod_reel", sep = "")
    } else {
      gtype = paste(gtype, "rod_reel", sep = ", ")
    }
  }
  if(responses$other_gear[i] == 1) {
    if(gtype == "") { 
    gtype = paste(gtype, "other", sep = "")
    #just use "other" for fewer categories
    }else {
      inrole = paste(gtype, "other", sep = ", ")
    }
  }
  responses$gear_type[i] = gtype
}
# #add if details wanted about other role  
# if(responses$other_gear[i] == 1) {
# if(gtype == "") {
# gtype = paste(gtype, responses$other_gear_descrip[i], sep = "")
# # paste in what the person put for "other"
# }else {
# gtype = paste(gtype, responses$other_gear_descrip[i], sep = ", ")
# }
# # }
# responses$gear_type[i] = gtype
# }



```

#gender, age, income, tribe demographic summaries

#q12 Do you currently participate in fisheries in other parts of the country?
```{r responses for q12 - 17}
#q12 Do you currently participate in fisheries in other parts of the country?
responses$other_fisheries<-factor(responses$other_fisheries, levels = c("yes", "no"))

otherfisheries_plot <- ggplot(data = responses, aes (x=other_fisheries))+
 geom_bar(aes(y = (..count..)/sum(..count..)), fill = "#749dae")+
  scale_y_continuous(labels=scales::percent) +
  xlab("other fisheries\n")+ ylab("percent") +
  ggtitle("Fishery participation outside region") #Do you participate in fisheries in other parts of the country?

ggsave(plot = otherfisheries_plot, file = paste0("../figures/resp_sum/other_fisheries.png"))
```

#q13 is an open ended response asking what other regions if the previous answer was yes

#q14 how much income comes from outside of fishing
```{r income}

responses$income <- factor(responses$income, levels = c("none", "U10", "10-25", "25-50", "50+"))

responses_income_plot <- ggplot(data = responses, aes(x=income))+
  geom_bar(aes(y = (..count..)/sum(..count..)), fill = pal5)+
  scale_y_continuous(labels=scales::percent) +
  xlab("percent income\n")+ ylab("percent") +
  ggtitle("% of income from outside fishing") 

ggsave(plot = responses_income_plot, file = paste0("../figures/resp_sum/responses_income.png"))

income <- responses %>% 
  select(income) %>% 
  gather(income) %>% 
  group_by(income) %>% 
  count(income)  %>% 
  mutate(survey = 418) %>% 
  mutate(prop = n/survey*100)
income
```

#q15 how old are you
```{r age}
responses$age <- factor(responses$age, levels = c("U30", "30-40", "40-50", "50-60", "60-70", "70+"))

responses_by_age_plot <- ggplot(data = responses, aes(x=age))+
  geom_bar(position = position_dodge(),stat = "count")
ggsave(plot = responses_by_age_plot, file = paste0("../figures/resp_sum/responses_age.png"))

#by percentage
ages_pct_plot <- ggplot(data = responses, aes(x=age))+
  geom_bar(aes(y = (..count..)/sum(..count..)))+
  scale_y_continuous(labels=scales::percent) +
  xlab("age\n")+ ylab("percent") +
   ggtitle("Age groups")
ggsave(plot = ages_pct_plot, file = paste0("../figures/resp_sum/age_pct.png"))

#to fill out the
age <- responses %>% 
  select(age) %>% 
  gather(age) %>% 
  group_by(age) %>% 
  count(age)  %>% 
  mutate(survey = 418) %>% 
  mutate(prop = n/survey*100)
age
```

#q16 What is your gender identity?
```{r gender}
responses$gender <- factor(responses$gender, levels = c("female", "male", "no_response", "other"))

responses_gender_plot <- ggplot(data = responses, aes(x=gender))+
  geom_bar(position = position_dodge(),stat = "count")
ggsave(plot = responses_gender_plot, file = paste0("../figures/resp_sum/responses_gender.png"))
```

#q17 are you an enrolled tribal member?
```{r tribe}
responses$tribe<-factor(responses$tribe, levels = c("yes", "no"))

tribe_plot <- ggplot(data = responses, aes (x=tribe))+
  geom_bar(fill = "#749dae", position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 16))+ ylab("Number of Respondents\n")+
  xlab("Category\n")+
  ggtitle("Are you an enrolled tribal member?") 

ggsave(plot = tribe_plot, file = paste0("../figures/resp_sum/tribe.png"))
```

##smoking and drinking
#q18 do you regularly smoke cigarettes
```{r smoking }

#saving these to wellbeing folder instead of general demographic summary location
responses$smoke<-factor(responses$smoke, levels = c("yes", "no"))

smoke_plot <- ggplot(data = responses, aes (x=smoke))+
  geom_bar(aes(y = (..count..)/sum(..count..)), fill = "navy blue")+
  scale_y_continuous(labels=scales::percent) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 16))+ ylab("Percent of Respondents\n")+
  ggtitle("Do you regularly smoke cigarettes?") 

ggsave(plot = smoke_plot, file = paste0("../figures/wellbeing/smoke.png"))
```

#q19 during the last 12 months on days when you drank alcohol many drinks did you usually have?
```{r drinking}
responses$alcohol<-factor(responses$alcohol, levels = c("1-2", "3-4", "5-6", "7-8", "8+", "NA", "prefer not to answer"))

drink_plot <- ggplot(data = responses, aes (x=alcohol))+
  geom_bar(aes(y = (..count..)/sum(..count..)), fill = "navy blue")+
  scale_y_continuous(labels=scales::percent) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 16))+ ylab("Percent of Respondents\n")+
  ggtitle("When you drink how many do you usually have?") 

ggsave(plot = drink_plot, file = paste0("../figures/wellbeing/drink.png"))

```

#observations of ocean change
```{r observations of change}
#changes you have observed in the last five years?
obs <- responses %>% 
  select(ability, ocean_temp, severe_weather, target_spp)
```

#q20r1 changes in ocean temperature 
#Figure 2a
```{r change in ocean temp}
ocean_temp <- responses %>% 
  select(ocean_temp) %>% 
  gather(ocean_temp) %>% 
  group_by(ocean_temp) %>% 
  count(ocean_temp)  %>% 
  mutate(survey = 418) %>% 
  mutate(prop = n/survey*100)
ocean_temp


obs <- obs %>% 
  mutate(ocean_temp = case_when(ocean_temp == "no_change" ~ "no change",
                                 ocean_temp == "increase" ~ "increase",
                                 ocean_temp == "decrease" ~ "decrease"))

obs$ocean_temp <- factor(obs$ocean_temp, levels = c("increase", "decrease", "no change"))

oceanobs_plot <- ggplot(data = obs, aes (x=ocean_temp))+
  geom_bar(fill = "black", position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 16))+ ylab("Number of Respondents\n")+
  xlab("Response\n")+
  ggtitle("Changes in ocean temp") 

ggsave(plot = oceanobs_plot, file = paste0("../figures/resp_sum/ocean_temp_obs.png"))

oceanobs_plot_pct <- ggplot(data = obs, aes (x=ocean_temp))+
  geom_bar(aes(y = (..count..)/sum(..count..)))+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 15), axis.text.y = element_text(size = 15))+ 
  scale_y_continuous(labels=scales::percent, limits = c(0,1)) +
  ylab("Percent Respondents\n")+
  xlab("Response\n")+
  ggtitle("(a) Ocean temperature") 
oceanobs_plot_pct

ggsave(plot = oceanobs_plot_pct, width = 7, height = 5, file = paste0("../figures/vulnerability_ms_figs/figure_2a_ocean_temp_obs_pct.png"))

```

#q20r2 changes in severe weather
```{r severe weather}
obs$severe_weather <- factor(obs$severe_weather, levels = c("no_change", "increase", "decrease"))

weatherobs_plot <- ggplot(data = obs, aes (x=severe_weather))+
  geom_bar(fill = "black", position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 16))+ ylab("Number of Respondents\n")+
  xlab("Category\n")+
  ggtitle("Observations of change in severe weather") 

ggsave(plot = weatherobs_plot, file = paste0("../figures/resp_sum/weather_obs.png"))

#as percentage
weatherobs_plot_pct <- ggplot(data = obs, aes (x=severe_weather))+
  geom_bar(aes(y = (..count..)/sum(..count..)))+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 15), axis.text.y = element_text(size = 15))+ 
  scale_y_continuous(labels=scales::percent, limits = c(0,1)) +
  ylab("Percent Respondents\n")+
  xlab("Response\n")+
  ggtitle("Observed changes in severe weather") 
weatherobs_plot_pct

ggsave(plot = weatherobs_plot_pct, width = 7, height = 5, file = paste0("../figures/vulnerability_ms_figs/weather_obs_pct.png"))
```

#q20r3 changes in target species - I would like to see this as a proportion - 
#Figure 2b
```{r target species}
target_spp <- responses %>% 
  select(target_spp) %>% 
  gather(target_spp) %>% 
  group_by(target_spp) %>% 
  count(target_spp)  %>% 
  mutate(survey = 418) %>% 
  mutate(prop = n/survey*100)
target_spp



obs <- obs %>% 
  mutate(target_spp = case_when(target_spp == "no_change" ~ "no change",
                                 target_spp == "increase" ~ "increase",
                                 target_spp == "decrease" ~ "decrease"))

obs$target_spp <- factor(obs$target_spp, levels = c("increase", "decrease", "no change"))

targetspp_plot <- ggplot(data = obs, aes (x=target_spp))+
  geom_bar(fill = "black", position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 16))+ ylab("Number of Respondents\n")+
  xlab("Response\n")+
  ggtitle("Observations of change in target species") 

ggsave(plot = targetspp_plot, file = paste0("../figures/resp_sum/targetspp_obs.png"))

#as percentage
targetspp_plot_pct <- ggplot(data = obs, aes (x=target_spp))+
  geom_bar(aes(y = (..count..)/sum(..count..)))+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 15), axis.text.y = element_text(size = 15))+ 
  scale_y_continuous(labels=scales::percent, limits = c(0,1)) +
  ylab("Percent Respondents\n")+
  xlab("Response\n")+
  ggtitle("(b) Target species") 
targetspp_plot_pct

ggsave(plot = targetspp_plot_pct, width = 7, height = 5, file = paste0("../figures/vulnerability_ms_figs/Figure_2b_targetspp_obs_pct.png"))
```

#observations of ocean change
#one figure and by percentages
```{r q20 observations of change}
#changes you have observed in the last five years?
obs$ocean_temp <- factor(obs$ocean_temp, levels = c("no_change", "increase", "decrease"))
obs$severe_weather <- factor(obs$severe_weather, levels = c("no_change", "increase", "decrease"))
obs$target_spp <- factor(obs$target_spp, levels = c("no_change", "increase", "decrease"))

#q20r1 changes in ocean temperature
oceanobs_plot <- ggplot(data = obs, aes (x=ocean_temp))+
  geom_bar(aes(y = (..count..)/sum(..count..)), fill = pal3)+
  scale_y_continuous(labels=scales::percent) +
  ylab("percent") +
  theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90)) +
   ggtitle("Ocean temperature") 

#q20r2 changes in severe weather
weatherobs_plot <- ggplot(data = obs, aes (x=severe_weather))+
  geom_bar(aes(y = (..count..)/sum(..count..)), fill = pal3)+
  scale_y_continuous(labels=scales::percent) +
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 90)) +
   ggtitle("Severe weather") 

#q20r3 changes in target species
targetspp_plot <- ggplot(data = obs, aes (x=target_spp))+
  geom_bar(aes(y = (..count..)/sum(..count..)), fill = pal3)+
  scale_y_continuous(labels=scales::percent, limits = c(0,1)) +
  theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.x = element_text(angle = 90)) +
   ggtitle("Target species")

obs_plot<-grid.arrange(oceanobs_plot, weatherobs_plot, targetspp_plot, nrow = 1, top = "Have you observed changes to the following?")

ggsave(plot = obs_plot, width = 12, height = 7, file = paste0("../figures/species_change/ocean_obs.png"))

```
##ability to catch fish has been affected by climate change
#Figure 2c
```{r ability to catch fish}
#q21 Do you think your ability to catch fish has been affected by climate change?
#This is an interesting plot, it doesn't appear people think that climate change has really impacted their ability to catch fish
#does this mean they think their fishing ability is indepent of climate change?
ability <- responses %>% 
  select(ability) %>% 
  gather(ability) %>% 
  group_by(ability) %>% 
  count(ability)  %>% 
  mutate(survey = 418) %>% 
  mutate(prop = n/survey*100)
ability


obs <- obs %>% 
   mutate(ability = case_when(ability == "no" ~ "no",
                                 ability == "no_obs_change" ~ "no observed change",
                                 ability == "yes_neg" ~ "yes, negatively",
                                 ability == "yes_pos" ~ "yes, positively"))

obs$ability <- factor(obs$ability, levels = c("yes, negatively", "yes, positively", "no", "no observed change"))


cc_ability_plot <- ggplot(data = obs, aes (x=ability))+
  geom_bar(aes(y = (..count..)/sum(..count..)))+
  # scale_y_continuous(labels=scales::percent, limits = c(0,1))+
  scale_y_continuous(labels=scales::percent, limits = c(0,0.3)) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+ 
  ylab("Percent Respondents\n")+
  xlab("Response\n")+
  ggtitle("(c) Ability to catch fish") 

cc_ability_plot

ggsave(plot = cc_ability_plot, width = 12, height = 7, file = paste0("../figures/vulnerability_ms_figs/figure_2c_abilitytofish.png"))

#q22 is an open ended question about how their ability to fish has been affected by climate change
```



##ability to catch fish has been affected by climate change
```{r ability to catch fish}
#Do you think your ability to catch fish has been affected by climate change?
#This is an interesting plot, it doesn't appear people think that climate change has really impacted their ability to catch fish
#does this mean they think their fishing ability is indepent of climate change?
belief$ability <- factor(belief$ability, levels = c("no", "no_obs_change", "yes_neg", "yes_pos"))

belief$age <- factor(belief$age, levels = c("U30", "30-40", "40-50", "50-60", "60-70", "70+"))

cc_ability_by_age_plot <- ggplot(data = belief, aes (x=ability, fill = age))+
  geom_bar(position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+ ylab("Number of Respondents\n")+
  xlab("Category\n")+
  ggtitle("Climate change has affected ability to catch fish") +
  scale_fill_manual(values = pal6)

ggsave(plot = cc_ability_by_age_plot, width = 10, height = 7, file = paste0("../figures/exploration/climate_change_ability_age.png"))

```

#see vulnerability code for q23-32
#see wellbeing code for q33 - 43

#saves data with state responses included
```{r save data}
write.csv(responses, paste0("../data/NE_decoded_responses_wstate", format(Sys.time(), "%d.%b.%Y"),".csv"))
```















#this was all moved to the beliefs code that is in the master


##Belief in climate change by State
```{r belief in climate change by State}
believe <- responses %>% 
  select(believe) %>% 
  gather(believe) %>% 
  group_by(believe) %>% 
  count(believe)  %>% 
  mutate(survey = 418) %>% 
  mutate(prop = n/survey*100)
believe
belief$believe <- factor(belief$believe, levels = c("strongly_disagree", "somewhat_disagree", "neutral", "somewhat_agree", "strongly_agree"))

belief$state <- factor(belief$state, levels = c("New Jersey","New York", "Connecticut", "Rhode Island", "Massachusetts", "New Hampshire", "Maine"))

cc_belief_state_plot <- ggplot(data = belief, aes (x=believe, fill = state))+
  geom_bar(position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+ ylab("Number of Respondents\n")+
  xlab("Category\n")+
  ggtitle("Believe that climate change is occuring")+
  scale_fill_manual(values = rev(pal7))

cc_belief_state_plot

ggsave(plot = cc_belief_state_plot, file = paste0("../figures/exploration/climate_change_belief_state.png"))

```

##Believe that climate change will harm them by State
```{r climate change harm me - state}
harm_me <- responses %>% 
  select(harm_me) %>% 
  gather(harm_me) %>% 
  group_by(harm_me) %>% 
  count(harm_me)  %>% 
  mutate(survey = 418) %>% 
  mutate(prop = n/survey*100)
harm_me
#Believe that climate change will harm them personally
belief$harm_me <- factor(belief$harm_me, levels = c("strongly_disagree", "somewhat_disagree", "neutral", "somewhat_agree", "strongly_agree"))

belief$state <- factor(belief$state, levels = c("New Jersey","New York", "Connecticut", "Rhode Island", "Massachusetts", "New Hampshire", "Maine"))

cc_harm_me_by_state_plot <- ggplot(data = belief, aes (x=harm_me, fill = state))+
  geom_bar(position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+ ylab("Number of Respondents\n")+
  xlab("Category\n")+
  ggtitle("Believe that climate change will harm them personally") +
  scale_fill_manual(values = rev(pal7))

cc_harm_me_by_state_plot

ggsave(plot = cc_harm_me_by_state_plot,width = 10, height = 7,  file = paste0("../figures/exploration/climate_change_harm_me_state.png"))

```

##Believe that climate change will harm future generations by State
```{r climate change harm future - state}
harm_future <- responses %>% 
  select(harm_future) %>% 
  gather(harm_future) %>% 
  group_by(harm_future) %>% 
  count(harm_future)  %>% 
  mutate(survey = 418) %>% 
  mutate(prop = n/survey*100)
harm_future
#Believe that climate change will harm future generations
belief$harm_future <- factor(belief$harm_future, levels = c("strongly_disagree", "somewhat_disagree", "neutral", "somewhat_agree", "strongly_agree"))

belief$state <- factor(belief$state, levels = c("New Jersey","New York", "Connecticut", "Rhode Island", "Massachusetts", "New Hampshire", "Maine"))

cc_harm_future_by_state_plot <- ggplot(data = belief, aes (x=harm_future, fill = state))+
  geom_bar(position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+ ylab("Number of Respondents\n")+
  xlab("Category\n")+
  ggtitle("Believe that climate change will harm future generations") +
  scale_fill_manual(values = rev(pal7))

ggsave(plot = cc_harm_future_by_state_plot, file = paste0("../figures/exploration/climate_change_harm_future_state.png"))

```


##Belief in climate change by age
```{r belief in climate change}
belief$believe <- factor(belief$believe, levels = c("strongly_disagree", "somewhat_disagree", "neutral", "somewhat_agree", "strongly_agree"))
belief$age <- factor(belief$age, levels = c("U30", "30-40", "40-50", "50-60", "60-70", "70+"))


cc_belief_age_plot <- ggplot(data = belief, aes (x=believe, fill = age))+
  geom_bar(position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+ ylab("Number of Respondents\n")+
  xlab("Category\n")+
  ggtitle("Believe that climate change is occuring") +
  scale_fill_manual(values = rev(pal6))

cc_belief_age_plot

ggsave(plot = cc_belief_age_plot, width = 10, height = 7, file = paste0("../figures/exploration/climate_change_belief_age.png"))

#as percent
cc_belief_age_pct <- ggplot(data = belief, aes(x=believe, fill = age))+
  geom_bar(aes(y = (..count..)/sum(..count..)), position = position_dodge())+
  scale_y_continuous(labels=scales::percent) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+
  xlab("Category\n")+ ylab("Percent\n") +
  ggtitle("Belief in climate change by age") +
  scale_fill_manual(values = pal6)
cc_belief_age_pct

ggsave(plot = cc_belief_age_pct, width = 10, height = 7, file = paste0("../figures/exploration/climate_change_belief_age_percent.png"))


```

##Believe that climate change will harm them by age
```{r climate change harm me - age}
#Believe that climate change will harm them personally
belief$harm_me <- factor(belief$harm_me, levels = c("strongly_disagree", "somewhat_disagree", "neutral", "somewhat_agree", "strongly_agree"))

belief$age <- factor(belief$age, levels = c("U30", "30-40", "40-50", "50-60", "60-70", "70+"))

cc_harm_me_by_age_plot <- ggplot(data = belief, aes (x=harm_me, fill = age))+
  geom_bar(position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+ ylab("Number of Respondents\n")+
  xlab("Category\n")+
  ggtitle("Believe that climate change will harm them personally")+
  scale_fill_manual(values = rev(pal6))

cc_harm_me_by_age_plot

ggsave(plot = cc_harm_me_by_age_plot, width = 10, height = 7, file = paste0("../figures/exploration/climate_change_harm_me_age.png"))

#as percent
cc_harm_me_age_pct <- ggplot(data = belief, aes(x=harm_me, fill = age))+
  geom_bar(aes(y = (..count..)/sum(..count..)), position = position_dodge())+
  scale_y_continuous(labels=scales::percent) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+
  xlab("Category\n")+ ylab("Percent\n") +
  ggtitle("Believe climate change will harm me by age") +
  scale_fill_manual(values = pal6)
cc_harm_me_age_pct

ggsave(plot = cc_harm_me_age_pct, width = 10, height = 7, file = paste0("../figures/exploration/cc_harm_me_age_percent.png"))



```

##Believe that climate change will harm future generations by age
```{r climate change harm future - age}
#Believe that climate change will harm future generations
belief$harm_future <- factor(belief$harm_future, levels = c("strongly_disagree", "somewhat_disagree", "neutral", "somewhat_agree", "strongly_agree"))

belief$age <- factor(belief$age, levels = c("U30", "30-40", "40-50", "50-60", "60-70", "70+"))

cc_harm_future_by_age_plot <- ggplot(data = belief, aes (x=harm_future, fill = age))+
  geom_bar(position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+ ylab("Number of Respondents\n")+
  xlab("Category\n")+
  ggtitle("Believe that climate change will harm future generations") +
  scale_fill_manual(values = rev(pal6))

cc_harm_future_by_age_plot

ggsave(plot = cc_harm_future_by_age_plot, width = 10, height = 7, file = paste0("../figures/exploration/climate_change_harm_future_age.png"))

#as percent
cc_harm_future_age_pct <- ggplot(data = belief, aes(x=harm_future, fill = age))+
  geom_bar(aes(y = (..count..)/sum(..count..)), position = position_dodge())+
  scale_y_continuous(labels=scales::percent) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+
  xlab("Category\n")+ ylab("Percent\n") +
  ggtitle("Believe climate change will harm future generations by age") +
  scale_fill_manual(values = pal6)
cc_harm_future_age_pct

ggsave(plot = cc_harm_future_age_pct, width = 10, height = 7, file = paste0("../figures/exploration/cc_harm_future_age_percent.png"))


```

##Belief in climate change by yrs fishing
```{r belief in climate change by yrs fishing}
belief$believe <- factor(belief$believe, levels = c("strongly_disagree", "somewhat_disagree", "neutral", "somewhat_agree", "strongly_agree"))
belief$yrs_fishing <- factor(belief$yrs_fishing, levels = c("0-5", "5-15", "15-25", "25+"))

#by count
cc_belief_yrs_fishing_plot <- ggplot(data = belief, aes (x=believe, fill = yrs_fishing))+
  geom_bar(position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+ ylab("Number of Respondents\n")+
  
  xlab("Category\n")+
  ggtitle("Believe that climate change is occuring") +
  scale_fill_manual(values = rev(pal4))
cc_belief_yrs_fishing_plot

ggsave(plot = cc_belief_yrs_fishing_plot, width = 10, height = 7, file = paste0("../figures/climate_change_belief_yrs_fishing.png"))

#as percent
cc_yrs_fishing_pct <- ggplot(data = belief, aes(x=believe, fill = yrs_fishing))+
  geom_bar(aes(y = (..count..)/sum(..count..)), position = position_dodge())+
  scale_y_continuous(labels=scales::percent) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+
  xlab("Category\n")+ ylab("Percent\n") +
  ggtitle("Believe climate change is occurings by Years Fishing") +
  scale_fill_manual(values = pal4)

cc_yrs_fishing_pct

ggsave(plot = cc_yrs_fishing_pct, width = 10, height = 7, file = paste0("../figures/exploration/climate_change_belief_yrs_fishing_pct.png"))
```

##Believe that climate change will harm them by yrs fishing
```{r climate change harm me - yrs fishing}
#Believe that climate change will harm them personally
belief$harm_me <- factor(belief$harm_me, levels = c("strongly_disagree", "somewhat_disagree", "neutral", "somewhat_agree", "strongly_agree"))

belief$yrs_fishing <- factor(belief$yrs_fishing, levels = c("0-5", "5-15", "15-25", "25+"))

cc_harm_me_by_yrs_fishing_plot <- ggplot(data = belief, aes (x=harm_me, fill = yrs_fishing))+
  geom_bar(position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+ ylab("Number of Respondents\n")+
  xlab("Category\n")+
  ggtitle("Believe climate change will be personally harmful by years fishing") +
  scale_fill_manual(values = pal4)

cc_harm_me_by_yrs_fishing_plot

ggsave(plot = cc_harm_me_by_yrs_fishing_plot, width = 10, height = 7, file = paste0("../figures/exploration/climate_change_harm_me_yrs_fishing.png"))

#as percent
harm_me_yrs_fishing_pct <- ggplot(data = belief, aes(x=harm_me, fill = yrs_fishing))+
  geom_bar(aes(y = (..count..)/sum(..count..)), position = position_dodge())+
  scale_y_continuous(labels=scales::percent) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+
  xlab("Category\n")+ ylab("Percent\n") +
  ggtitle("Believe climate change will be personally harmful by years fishing") +
  scale_fill_manual(values = pal4)
harm_me_yrs_fishing_pct

ggsave(plot = harm_me_yrs_fishing_pct, width=10, height = 7, file = paste0("../figures/exploration/cc_harm_me_yrs_fishing_pct.png"))

```

##Believe that climate change will harm future generations by yrs fishing
```{r climate change harm future - yrs fishing}
#Believe that climate change will harm future generations
belief$harm_future <- factor(belief$harm_future, levels = c("strongly_disagree", "somewhat_disagree", "neutral", "somewhat_agree", "strongly_agree"))

belief$yrs_fishing <- factor(belief$yrs_fishing, levels = c("0-5", "5-15", "15-25", "25+"))

cc_harm_future_by_yrs_fishing_plot <- ggplot(data = belief, aes (x=harm_future, fill = yrs_fishing))+
  geom_bar(position = position_dodge(), stat="count")+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+ ylab("Number of Respondents\n")+
  xlab("Category\n")+
  ggtitle("Believe that climate change will harm future generations")+
  scale_fill_manual(values = pal4) 

cc_harm_future_by_yrs_fishing_plot

ggsave(plot = cc_harm_future_by_yrs_fishing_plot, file = paste0("../figures/exploration/climate_change_harm_future_yrs_fishing.png"))

harm_future_yrs_fishing_pct <- ggplot(data = belief, aes(x=harm_future, fill = yrs_fishing))+
  geom_bar(aes(y = (..count..)/sum(..count..)), position = position_dodge())+
  scale_y_continuous(labels=scales::percent) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+
  xlab("Category\n")+ ylab("Percent\n") +
  ggtitle("Years Fishing") +
  scale_fill_manual(values = pal4)
harm_future_yrs_fishing_pct

ggsave(plot = harm_future_yrs_fishing_pct, width = 10, height = 7, file = paste0("../figures/exploration/cc_harm_future_yrs_fishing.png"))


```







```{r}

#don't believe climate change is occuring

cc_disagree <- responses %>% 
  filter(believe == "somewhat_disagree" |
         believe == "strongly_disagree") 
  
cc_disagree_top_concerns <- cc_disagree %>% 
  select(waterfront, covid_mkt, intl_trade, new_mkt, reliable_crew, fish_reg, quota, spp_dist, climate_chng, other_concern) %>% 
   gather(concern, response) %>% 
    group_by(concern) %>% 
    summarise(count = sum(response)) %>% 
    mutate(proportion = count/64)

cc_disagree_concern_plot <- ggplot()+
  geom_col(data = cc_disagree_top_concerns, aes(x=concern, y = proportion), fill = "#cd3341" )+
  xlab("Concern\n")+
  ylab("Proportion\n")+
  ggtitle(expression(atop("Top three concerns", atop(italic("disagree climate change is occuring (n = 64)"), ""))))+
   theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+
  scale_y_continuous(labels = scales::percent)

ggsave(plot = cc_disagree_concern_plot, height = 6 , width = 12 , file = paste0("../figures/cc_disagree_top_3_concern_plot.png"))

#neutral agreement on climate change occuring
cc_neutral <- responses %>% 
  filter(believe == "neutral")

cc_neutral_top_concerns <- cc_neutral %>% 
  select(waterfront, covid_mkt, intl_trade, new_mkt, reliable_crew, fish_reg, quota, spp_dist, climate_chng, other_concern) %>% 
   gather(concern, response) %>% 
    group_by(concern) %>% 
    summarise(count = sum(response)) %>% 
    mutate(proportion = count/54)

cc_neutral_concern_plot <- ggplot()+
  geom_col(data = cc_neutral_top_concerns, aes(x=concern, y = proportion), fill = "#f3c483" )+
  xlab("Concern\n")+
  ylab("Proportion\n")+
  ggtitle(expression(atop("Top three concerns", atop(italic("neither agree nor disagree (n = 54)"), ""))))+
   theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+
  scale_y_continuous(labels = scales::percent)

ggsave(plot = cc_neutral_concern_plot, height = 6 , width = 12 , file = paste0("../figures/cc_neutral_top_3_concern_plot.png"))

#believe climate change is occuring
cc_agree <- responses %>% 
  filter(believe == "somewhat_agree" |
         believe == "strongly_agree") 

cc_agree_top_concerns <- cc_agree %>% 
  select(waterfront, covid_mkt, intl_trade, new_mkt, reliable_crew, fish_reg, quota, spp_dist, climate_chng, other_concern) %>% 
   gather(concern, response) %>% 
    group_by(concern) %>% 
    summarise(count = sum(response)) %>% 
    mutate(proportion = count/300)

cc_agree_concern_plot <- ggplot()+
  geom_col(data = cc_agree_top_concerns, aes(x=concern, y = proportion), fill = "#749dae"  )+
  xlab("Concern\n")+
  ylab("Proportion\n")+
  ggtitle(expression(atop("Top three concerns", atop(italic("agree climate change is occuring (n = 300)"), ""))))+
   theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+
  scale_y_continuous(labels = scales::percent)
cc_agree_concern_plot

ggsave(plot = cc_agree_concern_plot, height = 6 , width = 12 , file = paste0("../figures/cc_agree_top_3_concern_plot.png"))

```

```{r}
top_concerns <- responses %>% 
  select(waterfront, covid_mkt, intl_trade, new_mkt, reliable_crew, fish_reg, quota, spp_dist, climate_chng, other_concern) %>% 
   gather(concern, response) %>% 
    group_by(concern) %>% 
    summarise(count = sum(response)) %>% 
    mutate(proportion = count/418)

concern_plot <- ggplot()+
  geom_col(data = top_concerns, aes(x=concern, y = proportion))+
  xlab("Concern\n")+
  ylab("Proportion\n")+
  ggtitle(expression(atop("Top three concerns")))+
   theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+
  scale_y_continuous(labels = scales::percent)
concern_plot

ggsave(plot = concern_plot, height = 6 , width = 12 , file = paste0("../figures/top_3_concern_plot.png"))

table(top_concerns)
```


